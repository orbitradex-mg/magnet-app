# Решение проблемы с потерей данных на Render

## Проблема

Вы заметили, что:
1. Периодически все обновляется
2. В списке заказов постоянно отображается только тестовый заказ #1825
3. Данные могут теряться

## Причина

На бесплатном плане Render.com используется **ephemeral (временная) файловая система**:
- База данных SQLite хранится в памяти сервера
- При перезапуске сервиса (автоматически раз в неделю или при деплое) база данных **теряется**
- Создается новая база с тестовым заказом

## Что я исправил

1. ✅ **Уменьшил частоту автообновления** с 5 до 30 секунд (было слишком часто)
2. ✅ **Улучшил логику создания тестового заказа** - теперь он создается ТОЛЬКО если база пустая
3. ✅ **Добавил логирование** для отслеживания операций с базой данных

## Решения проблемы

### Вариант 1: PostgreSQL на Render (БЕСПЛАТНО) ⭐ РЕКОМЕНДУЕТСЯ

Render предоставляет бесплатную PostgreSQL базу, которая сохраняет данные между перезапусками.

**Шаги:**
1. В Render Dashboard → "New +" → "PostgreSQL"
2. Создайте базу данных (бесплатно)
3. Скопируйте **Internal Database URL**
4. В настройках вашего backend сервиса добавьте переменную окружения:
   - `DATABASE_URL` = скопированный URL
5. Измените код для использования PostgreSQL вместо SQLite

### Вариант 2: Использовать Persistent Disk (ПЛАТНО ~$7/мес)

На платном плане Render можно использовать Persistent Disk для постоянного хранения файлов.

### Вариант 3: Регулярные бэкапы (Временное решение)

Создайте endpoint для экспорта/импорта базы данных и сохраняйте бэкапы регулярно.

## Как проверить

1. Создайте новый заказ через админ-панель
2. Подождите 5-10 минут
3. Обновите страницу
4. Если заказ исчез - значит база пересоздалась

## Текущее состояние

Сейчас:
- ✅ Данные сохраняются в рамках одного запуска сервиса
- ✅ Приложение работает корректно до перезапуска
- ❌ Данные теряются при перезапуске сервиса Render

**Рекомендация:** Переходите на PostgreSQL для постоянного хранения данных.


